<!DOCTYPE html>
<html dir="rtl" lang="he">

<head>
    <title>住  - 专 </title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'></text></svg>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Varela+Round&display=swap');
    </style>
    <style>
        body {
            /* font-family: Arial, sans-serif; */
            font-family: "Varela Round", sans-serif;
            text-align: right;
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            background: #fff;
            color: #222;
        }

        .autoMargin {
            margin: 0 auto;
            width: fit-content;
        }

        li {
            margin-bottom: 4px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            /* border: 1px solid #222; */
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        th:focus,
        td:focus,
        input:focus,
        button:focus,
        select:focus {
            outline: 2px solid #005fcc;
            outline-offset: 2px;
        }

        .project-row td div[title="砖 - 专 专转  拽"] {
            font-size: 0.9em;
            font-weight: normal;
            color: #555;
        }

        th:nth-child(3),
        .project-row td:nth-child(3),
        .chance-row td:nth-child(1) {
            border-left: 3px solid #ddd;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #e6f7ff;
        }

        .checkbox-container {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .checkbox-container label {
            margin-left: 15px;
        }

        .input-container-grid {
            display: grid;
            grid-template-columns: max-content auto;
            gap: 10px;
            align-items: center;
        }

        .input-container-grid label {
            grid-column: 1;
        }

        .input-container-grid input {
            grid-column: 2;
            width: 50px;
        }

        .input-container {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .input-container input[type="search"],
        .input-container input[type="number"] {
            padding: 5px;
            margin-left: 10px;
        }

        .input-container button {
            padding: 5px 10px;
            cursor: pointer;
        }

        .chance-row {
            background-color: #e0f7fa;
        }

        .total-row {
            background-color: #eeddc2 !important;
            font-weight: bold;
        }

        .bold {
            font-weight: bold;
        }

        .loader {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(45deg);
            z-index: 9999;
            background: rgba(0, 0, 0, 0.137);
            display: block;
            perspective: 1000px;
            border-radius: 50%;
            width: 348px;
            height: 348px;
            color: #7a96e4;
        }

        .loader:before,
        .loader:after {
            content: '';
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: inherit;
            height: inherit;
            border-radius: 50%;
            transform: rotateX(70deg);
            animation: 1.2s spin linear infinite;
        }

        .loader:after {
            color: #FF3D00;
            transform: rotateY(70deg);
            animation-delay: .4s;
        }

        @keyframes spin {

            0%,
            100% {
                box-shadow: .6em 0px 0 0px currentcolor;
            }

            12% {
                box-shadow: .6em .6em 0 0 currentcolor;
            }

            25% {
                box-shadow: 0 .6em 0 0px currentcolor;
            }

            37% {
                box-shadow: -.8em .8em 0 0 currentcolor;
            }

            50% {
                box-shadow: -.2em 0 0 0 currentcolor;
            }

            62% {
                box-shadow: -.2em -.2em 0 0 currentcolor;
            }

            75% {
                box-shadow: 0px -.2em 0 0 currentcolor;
            }

            87% {
                box-shadow: .2em -.2em 0 0 currentcolor;
            }
        }

        @media screen and (max-width: 1024px) {
            table {
                font-size: 14px;
            }

            th,
            td {
                padding: 6px 4px;
            }
        }

        @media screen and (max-width: 768px) {
            .table-wrapper {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                margin: 0 -15px;
                padding: 0 15px;
            }

            table {
                min-width: 800px;
            }
        }

        @media screen and (max-width: 480px) {
            body {
                padding: 10px;
                font-size: 14px;
            }

            h1 {
                font-size: 1.5em;
                margin-bottom: 15px;
            }

            h3 {
                font-size: 1.2em;
                margin-bottom: 10px;
            }

            input,
            button {
                font-size: 16px;
            }
        }

        h3 {
            margin-top: 30px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        /* Visually hidden class for accessibility */
        .visually-hidden {
            position: absolute !important;
            height: 1px;
            width: 1px;
            overflow: hidden;
            clip: rect(1px, 1px, 1px, 1px);
            white-space: nowrap;
        }

        fieldset {
            padding: 0;
            border: 0;
        }

        #results-caption {
            font-size: 1.5em;
            font-weight: bold;
            padding: 1em;
            text-align: right;

        }

        .main-flex {
            display: flex;
            flex-direction: row-reverse;
            align-items: flex-start;
            gap: 30px;
        }

        .form-container {
            flex: 1 1 0;
            min-width: 250px;
        }

        .form-group {
            display: inline-block
        }

        @media screen and (max-width: 900px) {
            .main-flex {
                gap: 15px;
            }
        }

        @media screen and (max-width: 600px) {
            .main-flex {
                flex-direction: column-reverse;
                align-items: stretch;
            }


        }

        .bottom-image {
            width: 100%;
            /* text-align: center; */
            margin-top: 20px;
        }

        .bottom-image #frame {
            /* max-height: 100px; */
            max-width: 400px;
            width: auto;
            height: auto;
            background: #fff !important;
            /* border-radius: 8px; */
            /* box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08); */
        }
    </style>
</head>

<body>
    <div class="autoMargin">
        <span id="loader" class="" aria-live="polite" aria-busy="false"></span>
        <h1>拽转 住  - 专 </h1>
        <div style="color: rgb(99, 99, 99);">砖  注砖 砖砖 注爪  专转 注 砖砖 转爪转</div>

        <div class="main-flex">

            <div class="form-container">
                <form aria-labelledby="form-title">
                    <fieldset>
                        <legend id="form-title" class="visually-hidden">专转 砖</legend>
                        <h3 id="status-title">专 转 注 砖</h3>
                        <div class="checkbox-container" role="group" aria-labelledby="status-title">
                            <label for="handicappedSubscriber"><input type="checkbox" id="handicappedSubscriber"
                                    value="HandicappedSubscriber"> 注 转</label>
                            <label for="combatReservistSubscriber"><input type="checkbox" id="combatReservistSubscriber"
                                    value="CombatReservistSubscriber">  拽专</label>
                            <label for="reservedDutySubscriber"><input type="checkbox" id="reservedDutySubscriber"
                                    value="ReservedDutySubscriber"> </label>
                            <label for="localSubscriber"><input type="checkbox" id="localSubscriber"
                                    value="LocalSubscriber"> 
                                注专</label>
                        </div>

                        <h3 id="percent-title">注专转</h3>
                        <div style="color: rgb(99, 99, 99);font-weight: normal; margin-bottom: 10px;"> 注  注
                            专砖
                            砖
                            砖转砖 注专 </div>
                        <div class="input-container-grid" role="group" aria-labelledby="percent-title">
                            <label for="combatPercent"> 砖专转  拽专: </label>
                            <input type="number" id="combatPercent" min="0" max="100" step="1" value="10"
                                aria-label=" 砖专转  拽专">
                            <label for="reservedPercent"> 砖专转 : </label>
                            <input type="number" id="reservedPercent" min="0" max="100" step="1" value="10"
                                aria-label=" 砖专转 ">

                            <label for="recurringSubscribersPercent"> 专砖  驻专拽:
                            </label>
                            <input type="number" id="recurringSubscribersPercent" min="0" max="100" step="1" value="90"
                                aria-label=" 专砖  驻专拽">

                        </div>

                        <h3 id="city-title">驻砖 驻 注专</h3>
                        <div class="input-container" role="group" aria-labelledby="city-title">
                            <label for="cityInput">注专: </label>
                            <input type="search" id="cityInput" list="cityList" value="" aria-label="专 注专">
                            <datalist id="cityList">
                                <option value="住">
                                <option value="砖拽">
                                <option value="专 注拽">
                                <option value="专 砖注">
                                <option value="转 砖砖">
                                <option value="">
                                <option value="专">
                                <option value="">
                                <option value="">
                                <option value="专砖">
                                <option value="驻专 专">
                                <option value="注转-转专砖">
                                <option value="爪驻 专">
                                <option value="祝 ">
                                <option value="转">
                                <option value="注">
                                <option value="注驻">
                                <option value="拽专转 拽">
                                <option value="拽专转 转">
                                <option value="拽专转 注拽专">
                                <option value="专注">
                            </datalist>
                            <button type="button" onclick="fetchAndDisplayProjects()"
                                aria-label="砖 转爪转">砖</button>
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>
        <div id="results" class="table-wrapper" aria-live="polite"></div>

        <div class="bottom-image">
            <div class="autoMargin">住 驻专住转,  注  爪 驻</div>
            <!-- <img src="https://picsum.photos/400/100" alt=" 砖 驻专住转" /> -->
            <div id="frame"
                style="width: 100%;margin: auto;background: rgba(0, 0, 0, 0.50);position: relative; z-index: 99998;">
                <iframe data-aa='2408072' src='//acceptable.a-ads.com/2408072/?size=Adaptive'
                    style='border:0; padding:0; width:70%; height:auto; overflow:hidden;display: block;margin: auto'></iframe>
            </div>
            <div>
                <h3>注专转</h3>
                <ul>
                    <li>住 住驻专 注转, 砖 住 转  转  专 转 砖 驻专拽</li>
                    <li> 专 砖 注  转 住专  砖</li>
                    <li>专 转 砖 驻专拽 住专 住驻专  专转 专转 驻 注</li>
                    <li>' 专砖  驻专拽' 专 驻专拽 驻专拽,  砖 专 砖-90% 爪  专转, 
                         驻专拽 转 专 住驻专 专砖 90% 住驻专  驻专拽 拽, 住 
                        注</li>
                    <li>砖专 砖 住驻专 转转 住驻专 住专, 住驻专 注  注 住住, 转转 砖 驻注 专 专转
                         拽</li>
                        <li>  驻专驻住专 住住拽 转 注转 :-)</li>
                </ul>
            </div>
            <!-- <div>
                <h3>爪专转 砖转</h3>
                <div>住转 砖 注  砖转   砖注 砖砖 砖 注 注  砖转砖  爪专 拽
                    注砖转 转</div>
            </div> -->
        </div>
    </div>
    <script>
        let data = {};
        let currentDate;

        async function fetchAndDisplayProjects() {
            const loader = document.getElementById('loader');
            loader.classList.add('loader');
            loader.setAttribute('aria-busy', 'true');

            const cityDescription = document.getElementById('cityInput').value.trim();
            const isLocal = document.getElementById('localSubscriber').checked;
            const isHandicapped = document.getElementById('handicappedSubscriber').checked;
            const isReserved = document.getElementById('reservedDutySubscriber').checked;
            const isCombat = document.getElementById('combatReservistSubscriber').checked;

            const combatPercent = parseFloat(document.getElementById('combatPercent').value) / 100 || 0;
            const reservedPercent = parseFloat(document.getElementById('reservedPercent').value) / 100 || 0;
            const recurringPercent = parseFloat(document.getElementById('recurringSubscribersPercent').value) / 100 || 0;

            // Helpers
            function fmtInt(n) {
                return (typeof n === 'number' && isFinite(n)) ? Math.round(n).toLocaleString('he-IL') : '-';
            }
            function renderCell(originalNum, calculatedNum) {
                const title = "砖 - 专 专转  拽";
                const origStr = fmtInt(originalNum);
                const calcStr = fmtInt(calculatedNum);
                if (calcStr === '-' || origStr === calcStr) return origStr;
                return `${origStr}<div title="${title}">(${calcStr})</div>`;
            }
            function showPctOrDash(v) {
                return (!isNaN(v) && isFinite(v)) ? (v * 100).toFixed(2) + '%' : '-';
            }

            try {
                if (Object.keys(data).length === 0) {
                    const queryString = "?firstApplicantIdentityNumber=&secondApplicantIdentityNumber=&ProjectStatus=4&Entitlement=1&PageNumber=1&PageSize=75&IsInit=true&";
                    const encodedString = encodeURIComponent(queryString);
                    const response = await fetch("https://www.dira.moch.gov.il/api/Invoker?method=Projects&param=" + encodedString, {
                        "headers": {
                            "User-Agent": "Mozilla/5.0",
                            "Accept": "application/json, text/plain, */*",
                            "Accept-Language": "he-IL,he;q=0.8,en-US;q=0.5,en;q=0.3",
                            "Sec-GPC": "1",
                            "Sec-Fetch-Dest": "empty",
                            "Sec-Fetch-Mode": "cors",
                            "Pragma": "no-cache",
                            "Cache-Control": "no-cache"
                        },
                        "referrer": "https://www.dira.moch.gov.il/ProjectsList",
                        "method": "GET",
                        "mode": "cors"
                    });

                    data = await response.json();
                    currentDate = new Date();
                } else {
                    // Small delay to visualize update
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }

                let projects = (data.ProjectItems || []).filter(item => item.CityDescription === cityDescription);

                // Sort by LotteryNumber ascending (numeric if possible)
                projects.sort((a, b) => {
                    const na = Number(a.LotteryNumber);
                    const nb = Number(b.LotteryNumber);
                    if (!isNaN(na) && !isNaN(nb)) return na - nb;
                    return String(a.LotteryNumber || '').localeCompare(String(b.LotteryNumber || ''));
                });

                const overallChances = [];

                if (projects.length > 0) {
                    // cumulative winners across projects
                    const cumulativeWinners = {
                        handicapped: 0,
                        combat: 0,
                        reservist: 0,
                        local: 0,
                        general: 0,
                        total: 0
                    };

                    // infer handicapped/local % from the first project (safely)
                    const first = projects[0];
                    const firstTotalSubscribers = Number(first.TotalSubscribers) || 0;
                    const inferredHandicappedPercent = firstTotalSubscribers > 0 ? (Number(first.TotalHandicappedSubscribers) || 0) / firstTotalSubscribers : 0;
                    const inferredLocalPercent = firstTotalSubscribers > 0 ? (Number(first.TotalLocalSubscribers) || 0) / firstTotalSubscribers : 0;

                    let tableHtml = `
                    <table aria-describedby="results-caption">
                        <caption id="results-caption">转 转爪转 住 </caption>
                        <thead>
                        <tr>
                            <th scope="col">专</th>
                            <th scope="col">注专</th>
                            <th scope="col">专 "专</th>
                            <th scope="col">专砖 注 转</th>
                            <th scope="col">专转 注 转</th>
                            <th scope="col">专砖  拽专</th>
                            <th scope="col">专转  拽专</th>
                            <th scope="col">专砖 </th>
                            <th scope="col">专转 </th>
                            <th scope="col">专砖  注专</th>
                            <th scope="col">专转  注专</th>
                            <th scope="col">住" 专砖</th>
                            <th scope="col">专转</th>
                            <th scope="col">住  </th>
                        </tr>
                        </thead>
                        <tbody>
                `;

                    projects.forEach((project, idx) => {
                        // ----- TOTAL subscribers: original (raw) -----
                        const raw_total_subs = Number(project.TotalSubscribers) || 0;

                        // This is the adjusted total used upstream for category estimates (recurring winners only).
                        const totalSubscribers = Math.max(0, Math.floor(raw_total_subs - recurringPercent * cumulativeWinners.total));

                        // ----- Handicapped: prefer API (>0), else inferred % of RAW total; then calculated (after recurring) -----
                        const apiHand = Number(project.TotalHandicappedSubscribers);
                        const orig_h = (Number.isFinite(apiHand) && apiHand > 0)
                            ? Math.floor(apiHand)
                            : Math.floor(raw_total_subs * inferredHandicappedPercent);
                        let subs_h = Math.max(0, Math.floor(orig_h - recurringPercent * cumulativeWinners.handicapped));

                        // ----- Combat: use API only if > 0, else % of RAW total; then calculated (after recurring) -----
                        const apiCombat = Number(project.TotalCombatReservistSubscribers);
                        const orig_c = (Number.isFinite(apiCombat) && apiCombat > 0)
                            ? Math.floor(apiCombat)
                            : Math.floor(combatPercent > 0 ? raw_total_subs * combatPercent : 0);
                        let subs_c = Math.max(0, Math.floor(orig_c - recurringPercent * cumulativeWinners.combat));

                        // ----- Reservists: use API only if > 0, else % of RAW total; then calculated (after recurring) -----
                        const apiReserved = Number(project.TotalReservedDutySubscribers);
                        const orig_r = (Number.isFinite(apiReserved) && apiReserved > 0)
                            ? Math.floor(apiReserved)
                            : Math.floor(reservedPercent > 0 ? raw_total_subs * reservedPercent : 0);
                        let subs_r = Math.max(0, Math.floor(orig_r - recurringPercent * cumulativeWinners.reservist));

                        // ----- Local: prefer API (>0), else inferred % of RAW total; then calculated (after recurring) -----
                        const apiLocal = Number(project.TotalLocalSubscribers);
                        const orig_l = (Number.isFinite(apiLocal) && apiLocal > 0)
                            ? Math.floor(apiLocal)
                            : Math.floor(raw_total_subs * inferredLocalPercent);
                        let subs_l = Math.max(0, Math.floor(orig_l - recurringPercent * cumulativeWinners.local));

                        // Units per category
                        const units_h = Number(project.HousingUnitsForHandicapped) || 0;
                        const units_c = Number(project.HU_CombatReservist_L) || 0;
                        const units_r = Number(project.HU_Reservists_L) || 0;
                        const units_l = Number(project.LocalHousing) || 0;
                        const total_units = Number(project.LotteryApparmentsNum) || 0;

                        // Price field
                        const price_per_unit = (project.PricePerUnit ?? '');

                        // Chances per category
                        const chance_h = isHandicapped && subs_h > 0 ? Math.min(1, units_h / subs_h) : 0;

                        // Winners per category and spillover (combat -> reservist)
                        const winners_h = Math.min(units_h, subs_h);

                        const winners_c = Math.min(units_c, subs_c);
                        const remaining_combat = Math.max(0, subs_c - winners_c);

                        // effective_subs_r is what is actually used for reservist chance
                        const effective_subs_r = Math.max(0, subs_r + remaining_combat);
                        const chance_c = isCombat && subs_c > 0 ? Math.min(1, units_c / subs_c) : 0;
                        const chance_r = (isReserved || isCombat) && effective_subs_r > 0 ? Math.min(1, units_r / effective_subs_r) : 0;

                        const winners_r = Math.min(units_r, effective_subs_r);

                        const chance_l = isLocal && subs_l > 0 ? Math.min(1, units_l / subs_l) : 0;
                        const winners_l = Math.min(units_l, subs_l);

                        // General lottery (don't subtract recurring general again; it's already baked into totalSubscribers)
                        let remaining_units = Math.max(0, total_units - (winners_h + winners_c + winners_r + winners_l));
                        let remaining_subs = Math.max(0, totalSubscribers - (winners_h + winners_c + winners_r + winners_l));
                        const chance_g = remaining_subs > 0 ? Math.min(1, remaining_units / remaining_subs) : 0;

                        // Overall chance (sequential draws)
                        let overall_chance = 0;
                        let prob_not_won = 1;
                        function safeAddChance(ch) {
                            if (!isNaN(ch) && isFinite(ch) && ch > 0) {
                                overall_chance += prob_not_won * ch;
                                prob_not_won *= (1 - ch);
                            }
                        }
                        safeAddChance(chance_h);
                        safeAddChance(chance_c);
                        safeAddChance(chance_r);
                        safeAddChance(chance_l);
                        safeAddChance(chance_g);

                        const overall_chance_percent = (!isNaN(overall_chance) && isFinite(overall_chance)) ? (overall_chance * 100).toFixed(2) + '%' : '-';
                        overallChances.push(!isNaN(overall_chance) && isFinite(overall_chance) ? Math.max(0, Math.min(1, overall_chance)) : 0);

                        // Update cumulative winners
                        const general_winners = Math.min(remaining_units, remaining_subs);
                        cumulativeWinners.handicapped += winners_h;
                        cumulativeWinners.combat += winners_c;
                        cumulativeWinners.reservist += winners_r;
                        cumulativeWinners.local += winners_l;
                        cumulativeWinners.general += general_winners;
                        cumulativeWinners.total =
                            cumulativeWinners.handicapped +
                            cumulativeWinners.combat +
                            cumulativeWinners.reservist +
                            cumulativeWinners.local +
                            cumulativeWinners.general;

                        // Rows (now showing calculated values that match the actual chance denominators)
                        tableHtml += `
                        <tr class="project-row">
                            <td>${project.LotteryNumber || ''}</td>
                            <td>${project.CityDescription || ''}</td>
                            <td>${price_per_unit}</td>

                            <!-- Handicapped: original vs calculated (post-recurring) -->
                            <td class="bold">${renderCell(orig_h, subs_h)}</td>
                            <td>${fmtInt(units_h)}</td>

                            <!-- Combat: original vs calculated (post-recurring) -->
                            <td class="bold">${renderCell(orig_c, subs_c)}</td>
                            <td>${fmtInt(units_c)}</td>

                            <!-- Reservists: original vs calculated = effective_subs_r (includes spillover) -->
                            <td class="bold">${renderCell(orig_r, effective_subs_r)}</td>
                            <td>${fmtInt(units_r)}</td>

                            <!-- Local: original vs calculated (post-recurring) -->
                            <td class="bold">${renderCell(orig_l, subs_l)}</td>
                            <td>${fmtInt(units_l)}</td>

                            <!-- Total subscribers: original (API) vs calculated = remaining_subs (general pool denom) -->
                            <td class="bold">${renderCell(raw_total_subs, remaining_subs)}</td>
                            <!-- Total units: original vs calculated = remaining_units (general pool numerator) -->
                            <td>${renderCell(total_units, remaining_units)}</td>

                            <td></td>
                        </tr>
                    `;

                        tableHtml += `
                        <tr class="chance-row">
                            <td colspan="3">住 </td>
                            <td>${isHandicapped ? showPctOrDash(chance_h) : '-'}</td>
                            <td></td>
                            <td>${isCombat ? showPctOrDash(chance_c) : '-'}</td>
                            <td></td>
                            <td>${(isReserved || isCombat) ? showPctOrDash(chance_r) : '-'}</td>
                            <td></td>
                            <td>${isLocal ? showPctOrDash(chance_l) : '-'}</td>
                            <td></td>
                            <td>${showPctOrDash(chance_g)}</td>
                            <td></td>
                            <td>${overall_chance_percent}</td>
                        </tr>
                    `;
                    });

                    const total_city_chance_val = overallChances.length > 0
                        ? (1 - overallChances.reduce((product, chance) => product * (1 - chance), 1))
                        : 0;
                    const total_city_chance_percent = (!isNaN(total_city_chance_val) && isFinite(total_city_chance_val))
                        ? (Math.max(0, Math.min(1, total_city_chance_val)) * 100).toFixed(2) + '%'
                        : '-';

                    tableHtml += `
                    <tr class="total-row">
                        <td colspan="13">住   注专</td>
                        <td>${total_city_chance_percent}</td>
                    </tr>
                    </tbody>
                    </table>
                `;

                    document.getElementById('results').innerHTML = tableHtml;

                    // timestamp
                    const day = String(currentDate.getDate()).padStart(2, '0');
                    const month = String(currentDate.getMonth() + 1).padStart(2, '0');
                    const year = String(currentDate.getFullYear()).slice(-2);
                    const dateString = `${day}.${month}.${year}`;
                    const timeString = currentDate.toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' });
                    document.getElementById('results').innerHTML += `
                    <p>注  ${dateString} ${timeString} (专注 祝  转 砖)</p>
                `;
                } else {
                    document.getElementById('results').innerHTML = `<p role="alert"> 爪 驻专拽 注 转专 注专 '${cityDescription}'.</p>`;
                }
            } catch (error) {
                document.getElementById('results').innerHTML = `<p role="alert">专注 砖: ${error.message}</p>`;
            } finally {
                loader.classList.remove('loader');
                loader.setAttribute('aria-busy', 'false');
            }
        }
    </script>

</body>

</html>